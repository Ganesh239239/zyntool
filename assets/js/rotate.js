let files=[];document.addEventListener('DOMContentLoaded',function(){document.getElementById('fileInput').addEventListener('change',function(e){files=Array.from(e.target.files);if(files.length){document.getElementById('toolOptions').classList.add('active');document.getElementById('previewArea').classList.add('active');const reader=new FileReader();reader.onload=function(e){document.getElementById('preview').src=e.target.result};reader.readAsDataURL(files[0])}});document.getElementById('rotateBtn').addEventListener('click',function(){if(!files.length){alert('Select images');return}document.getElementById('loading').classList.add('active');const angle=parseInt(document.getElementById('angle').value);let done=0;files.forEach((file,i)=>{const reader=new FileReader();reader.onload=function(e){const img=new Image();img.onload=function(){const canvas=document.createElement('canvas');const ctx=canvas.getContext('2d');if(angle===90||angle===270){canvas.width=img.height;canvas.height=img.width}else{canvas.width=img.width;canvas.height=img.height}ctx.translate(canvas.width/2,canvas.height/2);ctx.rotate((angle*Math.PI)/180);ctx.drawImage(img,-img.width/2,-img.height/2);canvas.toBlob(function(blob){const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=file.name.replace(/\.[^/.]+$/,'')+'_rotated.jpg';setTimeout(()=>{a.click();URL.revokeObjectURL(url)},i*200);done++;if(done===files.length){document.getElementById('loading').classList.remove('active');alert('Rotated!')}},'image/jpeg',0.9)};img.src=e.target.result};reader.readAsDataURL(file)})})});