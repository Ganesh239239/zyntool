let files=[];document.addEventListener('DOMContentLoaded',function(){document.getElementById('fileInput').addEventListener('change',function(e){files=Array.from(e.target.files);if(files.length){document.getElementById('toolOptions').classList.add('active');document.getElementById('previewArea').classList.add('active')}});document.getElementById('quality').addEventListener('input',function(){document.getElementById('qualityVal').textContent=this.value});document.getElementById('convertBtn').addEventListener('click',function(){if(!files.length){alert('Select images');return}document.getElementById('loading').classList.add('active');const q=parseInt(document.getElementById('quality').value)/100;let done=0;files.forEach((file,i)=>{const reader=new FileReader();reader.onload=function(e){const img=new Image();img.onload=function(){const canvas=document.createElement('canvas');canvas.width=img.width;canvas.height=img.height;const ctx=canvas.getContext('2d');ctx.fillStyle='#fff';ctx.fillRect(0,0,canvas.width,canvas.height);ctx.drawImage(img,0,0);canvas.toBlob(function(blob){const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=file.name.replace(/\.[^/.]+$/,'')+'.jpg';setTimeout(()=>{a.click();URL.revokeObjectURL(url)},i*200);done++;if(done===files.length){document.getElementById('loading').classList.remove('active');alert('Converted!')}},'image/jpeg',q)};img.src=e.target.result};reader.readAsDataURL(file)})})});