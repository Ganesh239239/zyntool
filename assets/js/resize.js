let files=[];document.addEventListener('DOMContentLoaded',()=>{const input=document.getElementById('fileInput');const uploadArea=document.getElementById('uploadArea');const options=document.getElementById('toolOptions');const preview=document.getElementById('previewArea');const loading=document.getElementById('loading');const processBtn=document.getElementById('processBtn');const resetBtn=document.getElementById('resetBtn');input.addEventListener('change',e=>{files=Array.from(e.target.files).filter(f=>f.type.startsWith('image/'));if(files.length){options.classList.add('active');preview.classList.add('active');document.getElementById('options-content').innerHTML=`<div class="option-row"><div class="option-group"><label>Width (px):</label><input type="number" id="width" value="800" min="1"></div><div class="option-group"><label>Height (px):</label><input type="number" id="height" value="600" min="1"></div></div><div class="option-group"><label><input type="checkbox" id="aspect" checked> Maintain aspect ratio</label></div>`;const reader=new FileReader();reader.onload=e=>{document.getElementById('previewContainer').innerHTML=`<img src="${e.target.result}" class="preview-image">`};reader.readAsDataURL(files[0])}});uploadArea.addEventListener('dragover',e=>{e.preventDefault();uploadArea.style.borderColor='#e74c3c'});uploadArea.addEventListener('dragleave',()=>{uploadArea.style.borderColor='#e1e8ed'});uploadArea.addEventListener('drop',e=>{e.preventDefault();uploadArea.style.borderColor='#e1e8ed';if(e.dataTransfer.files.length){input.files=e.dataTransfer.files;input.dispatchEvent(new Event('change'))}});processBtn.addEventListener('click',()=>{if(!files.length){alert('Select images first');return}loading.classList.add('active');const w=parseInt(document.getElementById('width').value);const h=parseInt(document.getElementById('height').value);setTimeout(()=>{files.forEach((file,i)=>{const reader=new FileReader();reader.onload=e=>{const img=new Image();img.onload=()=>{const canvas=document.createElement('canvas');canvas.width=w;canvas.height=h;const ctx=canvas.getContext('2d');ctx.drawImage(img,0,0,w,h);canvas.toBlob(blob=>{const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=file.name.replace(/\.[^/.]+$/,'')+'_resized.jpg';setTimeout(()=>{a.click();URL.revokeObjectURL(url)},i*200)});if(i===files.length-1){setTimeout(()=>{loading.classList.remove('active');alert('Done!')},files.length*200+500)}};img.src=e.target.result};reader.readAsDataURL(file)})},500)});resetBtn.addEventListener('click',()=>{files=[];input.value='';options.classList.remove('active');preview.classList.remove('active')})});