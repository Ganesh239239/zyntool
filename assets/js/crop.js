let originalImage=null;let canvas,ctx;document.addEventListener('DOMContentLoaded',function(){const fileInput=document.getElementById('fileInput');const uploadArea=document.getElementById('uploadArea');canvas=document.getElementById('cropCanvas');ctx=canvas.getContext('2d');fileInput.addEventListener('change',handleFile);uploadArea.addEventListener('dragover',(e)=>{e.preventDefault();uploadArea.classList.add('dragover')});uploadArea.addEventListener('dragleave',()=>{uploadArea.classList.remove('dragover')});uploadArea.addEventListener('drop',(e)=>{e.preventDefault();uploadArea.classList.remove('dragover');if(e.dataTransfer.files.length>0){handleFile({target:{files:[e.dataTransfer.files[0]]}})}});function handleFile(e){const file=e.target.files[0];if(!file||!file.type.startsWith('image/')){alert('Please select a valid image');return}const reader=new FileReader();reader.onload=function(event){originalImage=new Image();originalImage.onload=function(){canvas.width=originalImage.width;canvas.height=originalImage.height;ctx.drawImage(originalImage,0,0);document.getElementById('toolOptions').classList.add('active');document.getElementById('previewArea').classList.add('active')};originalImage.src=event.target.result};reader.readAsDataURL(file)}document.getElementById('cropBtn').addEventListener('click',function(){if(!originalImage)return;const x=parseInt(document.getElementById('cropX').value)||0;const y=parseInt(document.getElementById('cropY').value)||0;const width=parseInt(document.getElementById('cropWidth').value)||200;const height=parseInt(document.getElementById('cropHeight').value)||200;const croppedCanvas=document.createElement('canvas');croppedCanvas.width=width;croppedCanvas.height=height;const croppedCtx=croppedCanvas.getContext('2d');croppedCtx.drawImage(originalImage,x,y,width,height,0,0,width,height);croppedCanvas.toBlob(function(blob){const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='cropped_image.jpg';a.click();URL.revokeObjectURL(url);alert('Image cropped!')},'image/jpeg',0.9)});document.getElementById('resetBtn').addEventListener('click',function(){originalImage=null;fileInput.value='';document.getElementById('toolOptions').classList.remove('active');document.getElementById('previewArea').classList.remove('active')})});