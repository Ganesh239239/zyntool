let memeImg=null;document.addEventListener('DOMContentLoaded',function(){document.getElementById('fileInput').addEventListener('change',function(e){const file=e.target.files[0];if(!file)return;const reader=new FileReader();reader.onload=function(e){memeImg=new Image();memeImg.onload=function(){document.getElementById('toolOptions').classList.add('active');document.getElementById('previewArea').classList.add('active');updateMeme()};memeImg.src=e.target.result};reader.readAsDataURL(file)});['topText','bottomText'].forEach(id=>{document.getElementById(id).addEventListener('input',updateMeme)});function updateMeme(){if(!memeImg)return;const canvas=document.getElementById('memeCanvas');const ctx=canvas.getContext('2d');canvas.width=memeImg.width;canvas.height=memeImg.height;ctx.drawImage(memeImg,0,0);const top=document.getElementById('topText').value.toUpperCase();const bottom=document.getElementById('bottomText').value.toUpperCase();ctx.font='bold 48px Impact';ctx.fillStyle='white';ctx.strokeStyle='black';ctx.lineWidth=3;ctx.textAlign='center';if(top){ctx.strokeText(top,canvas.width/2,70);ctx.fillText(top,canvas.width/2,70)}if(bottom){ctx.strokeText(bottom,canvas.width/2,canvas.height-30);ctx.fillText(bottom,canvas.width/2,canvas.height-30)}}document.getElementById('genBtn').addEventListener('click',function(){if(!memeImg){alert('Select an image');return}document.getElementById('loading').classList.add('active');setTimeout(()=>{const canvas=document.getElementById('memeCanvas');canvas.toBlob(function(blob){const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='my_meme.jpg';a.click();URL.revokeObjectURL(url);document.getElementById('loading').classList.remove('active');alert('Meme created!')},'image/jpeg',0.9)},500)})});