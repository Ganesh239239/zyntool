---
import { getCollection } from 'astro:content';
import MainLayout from '../layouts/MainLayout.astro';

// Import the Tool Components
import CompressTool from '../components/tools/CompressTool.astro';
import ResizeTool from '../components/tools/ResizeTool.astro';
import CropTool from '../components/tools/CropTool.astro';
import WatermarkTool from '../components/tools/WatermarkTool.astro';

export async function getStaticPaths() {
  const toolEntries = await getCollection('tools');
  return toolEntries.map(entry => ({ params: { slug: entry.slug || entry.id }, props: { entry } }));
}
const { entry } = Astro.props;
const { Content } = await entry.render();
const toolId = entry.slug || entry.id;
---

<MainLayout title={entry.data.title}>
    <div class="tool-hero text-white" style={`background: linear-gradient(135deg, ${entry.data.color}, #1a202c);`}>
        <div class="container text-center">
            <h1 class="display-3 fw-black mb-2">{entry.data.title}</h1>
            <p class="opacity-75 fs-5">{entry.data.description}</p>
        </div>
    </div>

    <div class="container tool-container pb-5">
        <!-- RENDER THE SPECIFIC TOOL COMPONENT -->
        {toolId === 'compress-image' && <CompressTool entry={entry} />}
        {toolId === 'resize-image' && <ResizeTool entry={entry} />}
        {toolId === 'crop-image' && <CropTool entry={entry} />}
        {toolId === 'watermark-image' && <WatermarkTool entry={entry} />}
        
        <!-- Placeholder for tools we haven't split yet -->
        {!['compress-image', 'resize-image', 'crop-image', 'watermark-image'].includes(toolId) && 
            <p class="text-center py-5">Tool logic coming soon...</p>
        }

        <div class="content-section mt-5 pt-5 border-top">
            <article class="prose mx-auto"><Content /></article>
        </div>
    </div>
</MainLayout>
