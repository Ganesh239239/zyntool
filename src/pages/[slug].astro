---
import { getCollection } from 'astro:content';
import MainLayout from '../layouts/MainLayout.astro';

// Import React Islands
import CompressTool from '../components/tools/CompressTool.jsx';

export async function getStaticPaths() {
  const toolEntries = await getCollection('tools');
  return toolEntries.map(entry => ({ 
    params: { slug: entry.slug || entry.id }, 
    props: { entry } 
  }));
}

const { entry } = Astro.props;
const toolId = entry.slug || entry.id;
const { Content } = await entry.render();

// SEO Strategy
const seoTitle = `${entry.data.title} Online - 100% Free | ZynTool`;
---

<MainLayout title={seoTitle} isHome={false}>
    <!-- MINIMALIST APP HEADER -->
    <div class="tool-header-section">
        <div class="container-app">
            <div class="tool-icon-badge" style={`color: ${entry.data.color}; background: ${entry.data.color}10`}>
                <i class={`fa-solid ${entry.data.icon}`}></i>
            </div>
            <h1>{entry.data.title}</h1>
            <p>{entry.data.description}</p>
        </div>
    </div>

    <!-- REACT TOOL WORKSPACE -->
    <div class="container-app workspace-container">
        {toolId === 'compress-image' && <CompressTool client:load color={entry.data.color} />}
        
        {/* Placeholder for other tools */}
        {toolId !== 'compress-image' && (
            <div class="placeholder-box">Engine for {entry.data.title} is being modularized...</div>
        )}
    </div>

    <!-- SEO CONTENT -->
    <div class="container-app content-footer">
        <article class="prose-native">
            <Content />
        </article>
    </div>
</MainLayout>

<style>
    /* NATIVE CSS FOR LAYOUT */
    .tool-header-section {
        padding: 60px 0 30px;
        text-align: center;
    }
    .container-app {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
    }
    .tool-icon-badge {
        width: 60px; height: 60px;
        margin: 0 auto 20px;
        border-radius: 16px;
        display: flex; align-items: center; justify-content: center;
        font-size: 1.5rem;
        border: 1px solid rgba(0,0,0,0.05);
    }
    h1 { font-size: 42px; font-weight: 800; color: #1a202c; letter-spacing: -1px; }
    p { color: #64748b; font-size: 1.1rem; }

    .workspace-container { min-height: 400px; margin-bottom: 80px; }
    
    .placeholder-box {
        padding: 100px; text-align: center; border: 2px dashed #eee; border-radius: 20px; color: #aaa; font-weight: bold;
    }

    .content-footer { border-top: 1px solid #eee; padding-top: 60px; }
    .prose-native { max-width: 800px; margin: 0 auto; line-height: 1.7; color: #4a5568; }
</style>
