---
import { getCollection } from 'astro:content';
import MainLayout from '../layouts/MainLayout.astro';
import CompressTool from '../components/tools/CompressTool.astro';

export async function getStaticPaths() {
  const toolEntries = await getCollection('tools');
  return toolEntries.map(entry => ({ params: { slug: entry.slug || entry.id }, props: { entry } }));
}

const { entry } = Astro.props;
if (!entry) return Astro.redirect('/404');

const toolId = entry.slug || entry.id;
const { Content } = await entry.render();

const seoTitle = `${entry.data.title} Online - 100% Free | ZynTool`;
---

<MainLayout title={seoTitle}>
    <!-- NAVIGATION -->
    <div class="bg-white border-bottom py-2">
        <div class="container">
            <nav class="small fw-bold">
                <a href="/" class="text-muted text-decoration-none">Home</a>
                <span class="mx-2 text-muted">â€º</span>
                <span class="text-dark">{entry.data.title}</span>
            </nav>
        </div>
    </div>

    <!-- COMPACT TOOL WORKSPACE -->
    <div class="container py-4">
        <!-- The header stays simple -->
        <div id="tool-header-text" class="text-center mb-4">
            <h1 class="h2 fw-bold text-dark mb-1">{entry.data.title}</h1>
            <p class="text-muted small">{entry.data.description}</p>
        </div>

        <div id="main-tool-container">
            {toolId === 'compress-image' && <CompressTool entry={entry} />}
            {toolId !== 'compress-image' && <p class="text-center py-5">Logic coming soon...</p>}
        </div>

        <div class="mt-5 pt-5 border-top">
            <article class="prose mx-auto" style="max-width: 800px; color: #666;">
                <Content />
            </article>
        </div>
    </div>
</MainLayout>

<style>
    /* iLoveIMG typography */
    h1 { letter-spacing: -0.5px; }
    .prose { line-height: 1.7; font-size: 0.95rem; }
</style>
