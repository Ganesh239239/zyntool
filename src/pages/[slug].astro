---
import { getCollection } from 'astro:content';
import MainLayout from '../layouts/MainLayout.astro';

// Import React Islands
import CompressTool from '../components/tools/CompressTool.jsx';
import CropTool from '../components/tools/CropTool.jsx';
// ... other imports

export async function getStaticPaths() {
  const toolEntries = await getCollection('tools');
  return toolEntries.map(entry => ({
    params: { slug: entry.slug || entry.id }, 
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
const toolId = entry.slug || entry.id;
---

<MainLayout title={entry.data.title}>
    <!-- UNIQUE TOOL HEADER (Minimalist Developer Design) -->
    <div class="w-full bg-white pt-12 pb-6">
        <div class="container mx-auto px-4">
            <div class="flex flex-col items-center text-center">
                <!-- Small tool icon indicator -->
                <div class="w-12 h-12 rounded-2xl flex items-center justify-center mb-4 shadow-sm border border-slate-100" style={`color: ${entry.data.color}; background: ${entry.data.color}10`}>
                    <i class={`fa-solid ${entry.data.icon} text-xl`}></i>
                </div>
                <h1 class="text-3xl md:text-5xl font-[800] text-slate-900 tracking-tight mb-2">
                    {entry.data.title}
                </h1>
                <p class="text-slate-500 text-lg max-w-xl mx-auto font-medium leading-relaxed">
                    {entry.data.description}
                </p>
            </div>
        </div>
    </div>

    <!-- MAIN WORKSPACE: White Background, No Cards -->
    <div class="container mx-auto px-4 py-8">
        <div class="mb-20">
            {toolId === 'compress-image' && <CompressTool client:load entry={entry} />}
            {toolId === 'crop-image' && <CropTool client:load entry={entry} />}
            
            {/* Fallback */}
            {!['compress-image', 'crop-image'].includes(toolId) && (
               <div class="py-20 text-center text-slate-400 font-bold border-2 border-dashed border-slate-100 rounded-[32px]">
                  Engine conversion in progress...
               </div>
            )}
        </div>

        <!-- SEO CONTENT SECTION -->
        <div class="max-w-4xl mx-auto border-t border-slate-100 pt-16">
            <article class="prose prose-slate max-w-none 
                prose-headings:text-slate-900 prose-headings:font-black 
                prose-p:text-slate-600 prose-p:leading-relaxed">
                <Content />
            </article>
        </div>
    </div>
</MainLayout>
